---
title: "Blog"
author: "Kayla Manning"
date: "9/8/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# loading necessary packages

library(usmap)
library(tidyverse)
library(patchwork)
library(gt)
library(ggthemes)

```


```{r data, warning = FALSE, message=FALSE}

# reading in datasets from our first lab

popvote_df <- read_csv("lab1/popvote_1948-2016.csv")
pvstate_df <- read_csv("lab1/popvote_bystate_1948-2016.csv")

```

The US Electoral College system places a great importance on "swing states." However, the notion of electoral swing takes on several definitions, varying by context. For example, the label of "swing state" could indicate volatility between elections, such that it "swings" in one direction or another. Conversely, a "swing state" could also consistently post close races within a state that could *swing* either way. 

For the purpose of this analysis, electoral "swing" captures the magnitude of the change in a particular party's vote share between elections. In this case, a larger quantity indicates a larger swing.

For the past couple of decades, most states consistently voted either red or blue. However, Donald Trump flipped many reliably blue states to red in his 2016 victory, and, in the words of [Politico](https://www.politico.com/news/magazine/2020/02/07/election-2020-new-electoral-map-110496), "blew up" the Electoral Map. The below graphic displays shifts in the two-party vote across the country between the 2012 and 2016 presidential elections: 


```{r plot_2016, warning=FALSE}

# doing difference between 2016 and 2012

pv_swing_2016 <- pvstate_df %>%
  filter(year %in% c(2012, 2016)) %>%
  group_by(state) %>%
  arrange(year, .by_group = TRUE) %>%
  select(state, year, D_pv2p, R_pv2p) %>% 
  pivot_wider(names_from = year, values_from = c(D_pv2p, R_pv2p)) %>% 
  mutate(swing_margin = D_pv2p_2016 / (D_pv2p_2016 + R_pv2p_2016) -
           D_pv2p_2012 / (D_pv2p_2012 + R_pv2p_2012))

# plotting data, modified from lab code

plot_usmap(data = pv_swing_2016, regions = "states", 
           values = "swing_margin", labels = TRUE) +
    scale_fill_gradient2(
      high = "blue", 
      mid = "white",
      low = "red", 
      breaks = c(-0.1,-0.05,0.05,0.1), 
      limits = c(-0.1,0.1),
      name = "Change in Proportion \nof Democratic Votes"
    ) +
    theme_void() +
  labs(title = "Swing Margin from 2012 to 2016")

```

Positive values indicate blue-trending states, while negative values indicated red-trending states. In the above map, there are far more red-trending states than blue, indicating that Republican vote share increased in the 2016 presidential race relative to the 2012 race, as expected given the outcome of the election.

With the 2020 election on the horizon, the possibility of electoral swing has become increasingly important. Research by (Gallup)[https://news.gallup.com/poll/313079/mood-doesn-bright-incumbents-win.aspx] reveals that an incumbent can still win re-election in the face of low approval numbers, so a Democratic victory in 2020 requires enough red states from 2016 to swing blue.

To take a closer look at trends between 2012 and 2016, it is helpful to identify key *battleground* states that have swung in one direction or another. To begin, one must define 
*battleground state*. Generally, *battleground states* have a close race between the two competing parties. For the purpose of this analysis, I defined *battleground states* as those with vote shares between 45% and 55% in at least one of the 2012 and 2016 presidential elections. The below table displays these battleground states and their respective changes in two-party Democratic vote share:

```{r big_dem_change_2016, message=FALSE}

# finding top 10 change in Democrat note that GA & TX are creeping closer to
# turning blue UT change may just be because Mitt Romney ran in 2012

pv_swing_2016 %>% 
  select(state, D_pv2p_2012, D_pv2p_2016, swing_margin) %>% 
  filter((D_pv2p_2012 > 45 & D_pv2p_2012 < 55) |
         (D_pv2p_2016 > 45 & D_pv2p_2016 < 55)) %>% 
  
  # rounding the numbers in the table and converting the swing margin to
  # increase ease of readability
  
  mutate(swing_margin = swing_margin * 100) %>% 
  mutate_if(is.numeric, ~round(., 2)) %>% 
  arrange(desc(swing_margin)) %>% 
  ungroup() %>% 
  gt() %>% 
  tab_header("Swinging Battleground States in 2016",
             "Proportions of the Two-Party Vote") %>% 
  tab_footnote(
    "Difference in the Democratic percentage of the two-party vote from 2012 to 2016",
    cells_column_labels(vars(swing_margin))
    ) %>% 
  cols_label(
    state = "State",
    D_pv2p_2012 = "Democratic Vote \nin 2012 (%)",
    D_pv2p_2016 = "Democratic Vote \nin 2016 (%)",
    swing_margin = "Change in Share \nof Democratic Vote (%)"
  ) 

```
Of the states that met the pre-defined *battleground* criteria, three out of four of the blue-trending battleground states voted Republican in both elections, with none of the blue-trending states flipping. Likewise, the vast majority of red-trending battleground states voted Democrat in 2012.

Texas exhibited the largest Democratic shift, followed by Arizona and Georgia. If the trends in these states continue over time, they could reasonably flip to blue in the next few election cycles. 

In the 2016 election, Florida, Pennsylvania, Wisconsin, Michigan, Ohio, and Iowa flipped from blue to red, with Iowa doing so by the largest margin. While Maine missed the mark to flip in 2016 by a narrow margin, the state could plausibly vote Republican in 2020 if the trend continues. In general, red-trending states saw shifts of a larger magnitude than blue-trending states:

```{r margin_graph}

pv_swing_2016 %>% 
  select(state, D_pv2p_2012, D_pv2p_2016, swing_margin) %>% 
  filter((D_pv2p_2012 > 45 & D_pv2p_2012 < 55) |
         (D_pv2p_2016 > 45 & D_pv2p_2016 < 55)) %>%
  
  # rounding the numbers in the table and converting the swing margin to
  # increase ease of readability
  
  mutate(swing_margin = swing_margin * 100,
         toward_dem = as.factor(ifelse(swing_margin > 0, 1, 0)),
         state = as_factor(state)) %>%
  ggplot(aes(fct_reorder(state, swing_margin), swing_margin, fill = toward_dem)) + 
  geom_col() +
  coord_flip() +
  scale_fill_manual(values = c("blue", "red")) +
  theme_classic() + 
  labs(title = "Swing from 2012 to 2016 in Battleground States",
       y = "Change in Share of Democratic Vote",
       x = "State") +
  scale_y_continuous(limits = c(-8.5, 8.5), breaks = seq(-8, 8, 2)) +
  theme(legend.position = "none")

```


Of course, the additional context of COVID-19, the resulting economic turmoil, and racial protests around the country add additional noise to the election not captured in the trends observed between 2012 and 2016. However, patterns of the past lay the groundwork for the future, and shifting ideological trends in states may prove worthwhile when anticipating the results in November.


